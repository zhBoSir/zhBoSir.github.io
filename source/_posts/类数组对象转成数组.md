---
title: 类数组对象转成数组
date: 2019-06-28 10:28:35
---

>Demo:
```
// 将类数组对象转换成数组

var args = []; 
var obj = {0:"www",1:"jianshu",2:"com",length:3};

for (var i = 0; i < obj.length; i++) { 
    args.push(obj[i]);
}

console.log(args);  //["www","jianshu","com"]
//等价于以下的写法
console.log([].slice.call(obj));  //["www","jianshu","com"]

//等价于以下的写法
console.log(Array.prototype.slice.call(obj));  //["www","jianshu","com"]
```

>原理解析：
- javascirpt的<code>类数组对象</code>可以像数组一样使用for循环遍历，但是却<u>不能调用数组原型链的方法</u>，为了让类数组对象可以像数组对象一样调用push，pop等方法，可以将类数组对象转成数组对象，使用上面的Demo代码即可。
- 理解<code>[].slice.call(arguments)</code>的原理，需要明白：
  - <code>slice()</code>方法的作用
  - <code>call()</code>方法的作用
  - <code>slice()</code>方法的内部实现

call方法的理解：

Function.prototype.call()
```
function func(name, price) {
  this.name = name;
  this.price = price;
}
var food = {name:"apple",price:10};
func.call(food,"orange",15);
console.log(food); // {name: "orange", price: 15}
```
call方法的作用就是：用call方法的第一个参数代替func方法内部的this，其他参数为原func方法的参数。

- 关键理解点

<code>slice方法内部实现  
slice方法内部实现，其基本原理就类似我们上面开头写的for循环遍历原数组，根据start和end的值再复制一份到新数组并返回。所以当我们使用[].slice.call(arguments)，slice方法内部的this就会被替换成arguments，并循环遍历arguments，复制到新数组返回，这样就得到了一个复制arguments类数组的数组对象。</code>

- 为了提高性能，减少一层对原型链的追溯，一般我们会采用以下的写法：

```
Array.prototype.slice.call(arguments)
```

参考：

[[].slice.call(arguments)原理解析](https://www.jianshu.com/p/f76011a705f6)

