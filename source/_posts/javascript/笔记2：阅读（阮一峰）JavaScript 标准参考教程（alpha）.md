---
title: 笔记2：阅读（阮一峰）JavaScript 标准参考教程（alpha）
date: 2019-03-09 09:48:51
categories:
  - JavaScript
tags: 
---

**16.** Object.keys方法返回数组的所有键名。
```
var arr = ['a', 'b', 'c'];

Object.keys(arr)
// ["0", "1", "2"]
```
数组成员的键名是固定的（默认总是0、1、2...），对象的键名一律为字符串，所以，数组的键名其实也是字符串。之所以可以用数值读取，是因为非字符串的键名会被转为字符串。

**17.** 对象有两种读取成员的方法：点结构（object.key）和方括号结构（object[key]）。但是，对于数值的键名，不能使用点结构。
```
var arr = [1, 2, 3];
arr.0 // SyntaxError
```
arr.0的写法不合法，因为单独的数值不能作为标识符（identifier）。所以，数组成员只能用方括号arr[0]表示（方括号是运算符，可以接受数值）。

**18.** 只要是数组，就一定有length属性。该属性是一个动态的值，等于键名中的最大整数加上1。
```
var arr = ['a', 'b'];
arr.length // 2

arr[2] = 'c';
arr.length // 3

arr[9] = 'd';
arr.length // 10

arr[1000] = 'e';
arr.length // 1001
```
上面代码表示，数组的数字键不需要连续，length属性的值总是比最大的那个整数键大1。另外，这也表明数组是一种动态的数据结构，可以随时增减数组的成员。
length属性是可写的。如果人为设置一个小于当前成员个数的值，该数组的成员会自动减少到length设置的值。
```
var arr = [ 'a', 'b', 'c' ];
arr.length // 3

arr.length = 2;
arr // ["a", "b"]
```
上面代码表示，当数组的length属性设为2（即最大的整数键只能是1）那么整数键2（值为c）就已经不在数组中了，被自动删除了。

清空数组的一个有效方法，就是将length属性设为0。
```
var arr = [ 'a', 'b', 'c' ];

arr.length = 0;
arr // []
```
如果人为设置length大于当前元素个数，则数组的成员数量会增加到这个值，新增的位置都是空位，读取新增的位置都会返回undefined。
```
var a = ['a'];

a.length = 3;
a[1] // undefined
```
由于数组本质上是一种对象，所以可以为数组添加属性，但是这不影响length属性的值。
```
var a = [];

a['p'] = 'abc';
a.length // 0

a[2.1] = 'abc';
a.length // 0
```
上面代码将数组的键分别设为字符串和小数，结果都不影响length属性。因为，length属性的值就是等于最大的数字键加1，而这个数组没有整数键，所以length属性保持为0。

**19.** 检查某个键名是否存在的运算符in，适用于对象，也适用于数组。
```
var arr = [ 'a', 'b', 'c' ];
2 in arr  // true
'2' in arr // true
4 in arr // false
```
上面代码表明，数组存在键名为2的键。由于键名都是字符串，所以数值2会自动转成字符串。

注意，如果数组的某个位置是空位，in运算符返回false。
```
var arr = [];
arr[100] = 'a';

100 in arr // true
1 in arr // false
```
上面代码中，数组arr只有一个成员arr[100]，其他位置的键名都会返回false。

**20.** for...in循环不仅可以遍历对象，也可以遍历数组，毕竟数组只是一种特殊对象。for...in遍历出来的是键名。
```
var a = [1, 2, 3];
for (var i in a) {
  console.log(a[i]);
}
// 1
// 2
// 3
```
数组的forEach方法，可以用来遍历数组。forEach遍历出来时键值。
```
var colors = ['red', 'green', 'blue'];
colors.forEach(function (color) {
  console.log(color);
});
// red
// green
// blue
```

**21.** 使用delete命令删除一个数组成员，会形成空位，并且不会影响length属性。
```
var a = [1, 2, 3];
delete a[1];

a[1] // undefined
a.length // 3
console.log(a)  // [1,,3]
```

**22.** 如果一个对象的所有键名都是正整数或零，并且有length属性，那么这个对象就很像数组，语法上称为“类似数组的对象”
```
var obj = {
  0: 'a',
  1: 'b',
  2: 'c',
  length: 3
};

obj[0] // 'a'
obj[1] // 'b'
obj.length // 3
obj.push('d') // TypeError: obj.push is not a function
```
上面代码中，对象obj就是一个类似数组的对象。但是，“类似数组的对象”并不是数组，因为它们不具备数组特有的方法。对象obj没有数组的push方法，使用该方法就会报错。

“类似数组的对象”的根本特征，就是具有length属性。只要有length属性，就可以认为这个对象类似于数组。但是有一个问题，这种length属性不是动态值，不会随着成员的变化而变化。而数组的length属性是动态值。
```
var obj = {
  length: 0
};
obj[3] = 'd';
obj.length // 0
```
上面代码为对象obj添加了一个数字键，但是length属性没变。这就说明了obj不是数组。

典型的“类似数组的对象”是函数的arguments对象，以及大多数 DOM 元素集，还有字符串。

**23.**  JavaScript 允许非数值的相加。
```
true + true // 2
1 + true // 2
```
如果一个运算子是字符串，另一个运算子是非字符串，这时非字符串会转成字符串，再连接在一起。
```
false + 'a' // "falsea"
```
由于从左到右的运算次序，字符串的位置不同会导致不同的结果。
```
'3' + 4 + 5 // "345"
3 + 4 + '5' // "75"
```

除了加法运算符，其他算术运算符它们的规则是：所有运算子一律转为数值，再进行相应的数学运算。
```
1 - '2' // -1
1 * '2' // 2
1 / '2' // 0.5
```
**24.** 如果运算子是对象，必须先转成原始类型的值，然后再相加。
```
var obj = { p: 1 };
obj + 2 // "[object Object]2"
```
对象的toString方法默认返回[object Object]

对象转成原始类型的值，规则如下：
首先，自动调用对象的valueOf方法。
```
var obj = { p: 1 };
obj.valueOf() // { p: 1 }
```
一般来说，对象的valueOf方法总是返回对象自身，这时再自动调用对象的toString方法，将其转为字符串。
```
var obj = { p: 1 };
obj.valueOf().toString() // "[object Object]"
```

**25.** 余数运算符（%），运算结果的正负号由第一个运算子的正负号决定。
```
-1 % 2 // -1
1 % -2 // 1
```

**26.** 自增和自减运算符有一个需要注意的地方，就是放在变量之后，会先返回变量操作前的值，再进行自增/自减操作；放在变量之前，会先进行自增/自减操作，再返回变量操作后的值。
```
var x = 1;
var y = 1;

x++ // 1
++y // 2
```

**27.** 数值运算符的作用在于可以将任何值转为数值（与Number函数的作用相同）。
```
+true // 1
+[] // 0
+{} // NaN
```

**28.** 指数运算符（**）完成指数运算，前一个运算子是底数，后一个运算子是指数。
```
2 ** 4 // 16
```